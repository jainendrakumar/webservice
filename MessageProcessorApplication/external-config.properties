##############################################################################
# external-config.properties
# Configuration for Aggregation Service (LoadPipeline & MultiDestinationRake)
##############################################################################

# ──────────────────────────────────────────────────────────────────────────────
# Server Ports
# ──────────────────────────────────────────────────────────────────────────────

# Port for the LoadPipeline HTTP endpoint (/receive)
loadpipeline.server.port=9021

# Port for the MultiDestinationRake HTTP endpoint (/receive-mdr)
mdr.server.port=9022

# ──────────────────────────────────────────────────────────────────────────────
# REST Target Settings
# ──────────────────────────────────────────────────────────────────────────────

# URL to dispatch aggregated LoadPipeline payloads
target.loadpipeline.rest.url=http://localhost:6506/cris/dev/in/api/loadpipeline
# Enable or disable LoadPipeline HTTP dispatch
target.loadpipeline.rest.enabled=true

# URL to dispatch aggregated MultiDestinationRake payloads
target.mdr.rest.url=http://localhost:6506/cris/dev/in/api/multidestinationrake
# Enable or disable MDR HTTP dispatch
target.mdr.rest.enabled=true

# ──────────────────────────────────────────────────────────────────────────────
# Archiving Configuration
# ──────────────────────────────────────────────────────────────────────────────

# Archive both incoming and merged JSON messages
archiving.enabled=true
archive.incoming.root=archive/incoming
archive.merged.root=archive/merged

# ──────────────────────────────────────────────────────────────────────────────
# Consolidation & Bucket Flush
# ──────────────────────────────────────────────────────────────────────────────

# Time window (seconds) to group LoadPipeline messages
consolidation.timeframe=4
# Time window (seconds) to group MDR messages
mdr.consolidation.timeframe=5
# Max bucket size to trigger immediate flush (0 = disabled)
bucket.flush.size=1000

# ──────────────────────────────────────────────────────────────────────────────
# Throttling
# ──────────────────────────────────────────────────────────────────────────────

throttling.enabled=true
throttling.limit=5

# ──────────────────────────────────────────────────────────────────────────────
# Dead‑Letter & Reporting
# ──────────────────────────────────────────────────────────────────────────────

deadletterqueue=deadletterqueue
report.file.prefix=report_
report.mdr.file.prefix=report_mdr_

# ──────────────────────────────────────────────────────────────────────────────
# Archive Zipper (Daily ZIP + Retention)
# ──────────────────────────────────────────────────────────────────────────────

archive.zipper.enabled=true
archive.zip.cron=0 0 1 * * *
archive.zip.output.root=archive/zipped
archive.zip.maxFiles=10

# ──────────────────────────────────────────────────────────────────────────────
# File‑Based Ingestion (Optional)
# ──────────────────────────────────────────────────────────────────────────────

input.mode=folder
input.zip.file=
input.folder.path=input
incoming.priority=port
incoming.file.delay.seconds=10
